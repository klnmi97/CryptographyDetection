import sqlite3

lines = []
droppers = 0

for i in range(10):
    with open(f'../Workspace/samples_{i}.list', 'r') as f:
        # Read all lines and store them in a list
        lines.extend(f.read().splitlines()) 

# Open a connection to the database file
conn = sqlite3.connect('meta.db')

# Loop through the list and query the database for each value

for value in lines:
    cursor = conn.cursor()
    cursor.execute("SELECT dropper, downloader FROM meta WHERE sha256 = '%s'" % value)
    rows = cursor.fetchall()
    if rows[0][0] > 0 or rows[0][1] > 0:
        droppers += 1

print("Percent of droppers/downloaders is", droppers / len(lines) * 100)
# Close the database connection
conn.close()